{% extends "base.html" %}

{% block title %}Фриланс — DevConnect{% endblock %}

{% block content %}
<div class="card fade-in">
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
    <h1 style="color:#24292f;">
      <i class="fas fa-briefcase"></i> Фриланс
    </h1>
    <a href="{{ url_for('freelance_new') }}" class="btn btn-primary">
      <i class="fas fa-plus"></i> Опубликовать вакансию
    </a>
  </div>

  <form method="GET" class="search-form">
    <div style="display:grid; grid-template-columns: 2fr 1fr 1fr auto; gap:1rem; align-items:end;">
      <div class="form-group">
        <label for="q"><i class="fas fa-search"></i> Поиск</label>
        <input id="q" name="q" class="form-control" placeholder="Заголовок или описание" value="{{ q }}">
      </div>
      <div class="form-group">
        <label for="skill"><i class="fas fa-code"></i> Навык</label>
        <select id="skill" name="skill" class="form-control">
          <option value="">Любой</option>
          {% for s in all_skills %}
          <option value="{{ s }}" {% if s == skill_filter %}selected{% endif %}>{{ s }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="form-group">
        <label for="type"><i class="fas fa-filter"></i> Тип</label>
        <select id="type" name="type" class="form-control">
          <option value="">Все</option>
          <option value="hire" {% if job_type == 'hire' %}selected{% endif %}>Ищу исполнителя</option>
          <option value="work" {% if job_type == 'work' %}selected{% endif %}>Ищу работу</option>
        </select>
      </div>
      <div class="form-group">
        <label>&nbsp;</label>
        <button type="submit" class="btn btn-primary" style="height:42px;">
          <i class="fas fa-search"></i> Найти
        </button>
      </div>
    </div>
    <div style="margin-top:0.75rem; display:flex; gap:0.75rem; align-items:center;">
      <label style="display:flex; gap:0.5rem; align-items:center; color:#24292f;">
        <input type="checkbox" name="remote" value="1" {% if remote == '1' %}checked{% endif %}>
        Только удалёнка
      </label>
    </div>
  </form>
</div>

<div class="card fade-in">
  {% if jobs %}
  <div class="user-grid">
    {% for job in jobs %}
    <div class="user-card hover-lift">
      <div class="user-name" style="display:flex; justify-content:space-between; align-items:center;">
        <a href="{{ url_for('freelance_detail', job_id=job.id) }}" style="color:inherit; text-decoration:none;">{{ job.title }}</a>
        <span class="skill-tag">{{ 'Удалёнка' if job.is_remote else (job.location or 'Локация') }}</span>
      </div>
      <div style="color:#656d76; font-size:0.95rem; margin-bottom:0.75rem;">{{ job.description[:140] }}{% if job.description|length > 140 %}...{% endif %}</div>
      {% if job.skills %}
      <div class="user-skills">
        {% for s in job.skills.split(',')[:4] %}
        <span class="skill-tag">{{ s.strip() }}</span>
        {% endfor %}
      </div>
      {% endif %}
      <div style="display:flex; justify-content:space-between; align-items:center; margin-top:0.5rem;">
        <div style="font-size:0.9rem; color:#656d76;">
          {{ 'Ищу исполнителя' if job.job_type == 'hire' else 'Ищу работу' }} • {{ job.budget or 'Договорная' }}
        </div>
        <a class="btn btn-secondary" href="{{ url_for('freelance_detail', job_id=job.id) }}">Подробнее</a>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div style="text-align:center; color:#656d76; padding:2rem;">
    <i class="fas fa-briefcase" style="font-size:3rem; opacity:0.4; margin-bottom:0.75rem;"></i>
    <div>Пока нет публикаций. Будьте первым!</div>
  </div>
  {% endif %}
</div>
{% endblock %}
